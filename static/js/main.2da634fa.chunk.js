(this.webpackJsonpfrontend=this.webpackJsonpfrontend||[]).push([[0],{78:function(e,t,n){},79:function(e,t,n){},85:function(e,t,n){},86:function(e,t,n){},88:function(e,t,n){},89:function(e,t,n){},90:function(e,t,n){},91:function(e,t,n){},92:function(e,t,n){},93:function(e,t,n){},94:function(e,t,n){},95:function(e,t,n){},96:function(e,t,n){"use strict";n.r(t);var c,a,r,s,i,l,o=n(27),j=n(3),d=n.n(j),b=n(66),u=n.n(b),h=(n(78),n(13)),O=n(14),x=n(11),m=n(103),f=n(34),g=n(109),v=Object(g.a)(c||(c=Object(f.a)(["\n  {\n    onePerStore {\n      title\n      storeID\n      salePrice\n      normalPrice\n      thumb\n    }\n  }\n"]))),p=Object(g.a)(a||(a=Object(f.a)(["\n  query deals($start: Int, $storeID: String, $lowPrice: Float, $highPrice: Float, $sortBy: String) {\n    deals(start: $start, storeID: $storeID, lowPrice: $lowPrice, highPrice: $highPrice, sortBy: $sortBy) {\n      dealsList {\n        title\n        storeID\n        dealID\n        salePrice\n        normalPrice\n        thumb\n      }\n      isEnd\n    }\n  }\n"]))),S=Object(g.a)(r||(r=Object(f.a)(["\n  query dealById($id: String) {\n    dealById(id: $id) {\n      title\n      storeID\n      dealID\n      thumb\n      releaseDate\n      steamRatingText\n      dealRating\n      salePrice\n      normalPrice\n    }\n  }\n"]))),w=Object(g.a)(s||(s=Object(f.a)(["\n  query {\n    whoami\n  }\n"]))),y=Object(g.a)(i||(i=Object(f.a)(["\n    mutation TokenAuth($username: String!, $password: String!) {\n        tokenAuth(username: $username, password: $password){\n            token\n            payload\n        }\n    }\n"]))),D=Object(g.a)(l||(l=Object(f.a)(["\n    mutation CreateUser($username: String!, $password: String!){\n        createUser(username: $username, password: $password){\n            userCreationConfirm\n        }\n    }\n"]))),k=n(61),$=n(110),I=(n(79),n(1)),N={1:"steam-class",7:"gog-class",11:"humble-class"},P=function(e){var t=e.dealData,n=t.title,c=t.storeID,a=t.salePrice,r=t.normalPrice,s=t.thumb,i=t.dealID,l=N[c],o=i?"link-class":"",j=Object(I.jsxs)("div",{className:"".concat(l," ").concat(o," deal-card"),children:[Object(I.jsx)("div",{className:"thumb-container",children:Object(I.jsx)("img",{src:s,alt:n+" image"})}),Object(I.jsx)("h3",{children:n}),Object(I.jsxs)("h1",{children:[a,"$"]}),Object(I.jsxs)("p",{children:["Instead of ",r,"$"]})]});return i?Object(I.jsx)(O.b,{to:"/detail/".concat(i),style:{textDecoration:"none"},children:j}):j};n(85);function C(e){var t=e.dealsData,n=t.length>3?"dealsboard-4":"dealsboard-3";return Object(I.jsx)("div",{className:"dealsboard ".concat(n),children:t.map((function(e){return Object(I.jsx)(P,{dealData:e},e.title+e.storeID)}))})}n(86);function L(e){var t=e.variables,n=Object($.a)(p,{variables:Object(o.a)({start:0},t)}),c=n.data,a=(n.loading,n.error),r=n.fetchMore;if(a)return Object(I.jsx)("p",{children:"Oops! Something went wrong..."});if(c){var s=c.deals,i=s.dealsList,l=s.isEnd;return Object(I.jsxs)("div",{children:[Object(I.jsx)(C,{dealsData:i,className:"deals-board"}),l?null:Object(I.jsx)("button",{onClick:function(){return e=i.length,void r({variables:Object(o.a)({start:e},t),updateQuery:function(e,t){var n=t.fetchMoreResult;return{deals:{dealsList:[].concat(Object(k.a)(e.deals.dealsList),Object(k.a)(n.deals.dealsList)),isEnd:n.deals.isEnd}}}});var e},className:"loadmore-button",children:"Load More"})]})}return Object(I.jsx)("p",{children:"Loading..."})}n(88);function U(){var e=Object(j.useState)({}),t=Object(h.a)(e,2),n=t[0],c=t[1],a=Object(j.useState)({}),r=Object(h.a)(a,2),s=r[0],i=r[1],l=Object(j.useState)({}),d=Object(h.a)(l,2),b=d[0],u=d[1];return Object(I.jsxs)("div",{children:[Object(I.jsxs)("div",{className:"dashboard-selection-container",children:[Object(I.jsxs)("div",{children:[Object(I.jsx)("label",{htmlFor:"store-filter",children:"Store:"}),Object(I.jsxs)("select",{"data-testid":"store-filter",id:"store-filter",onChange:function(e){var t=e.target.value;console.log("STORE VALUE: ",t),c("default"===t?{}:{storeID:t})},children:[Object(I.jsx)("option",{value:"default",children:"Any"}),Object(I.jsx)("option",{value:"1",children:"Steam"}),Object(I.jsx)("option",{value:"7",children:"Gog"}),Object(I.jsx)("option",{value:"11",children:"Humble Store"})]})]}),Object(I.jsxs)("div",{children:[Object(I.jsx)("label",{htmlFor:"price-filter",children:"Price:"}),Object(I.jsxs)("select",{id:"price-filter","data-testid":"price-filter",onChange:function(e){var t=e.target.value;if("default"===t)i({});else{var n={1:[0,5],2:[5,25],3:[25,400]};i({lowPrice:n[t][0],highPrice:n[t][1]})}},children:[Object(I.jsx)("option",{value:"default",children:"Any"}),Object(I.jsx)("option",{value:"1",children:"0$ - 5$"}),Object(I.jsx)("option",{value:"2",children:"5$ - 25$"}),Object(I.jsx)("option",{value:"3",children:"more than 25$"})]})]}),Object(I.jsxs)("div",{children:[Object(I.jsx)("label",{htmlFor:"sort-by",children:"Sort:"}),Object(I.jsxs)("select",{id:"sort-by","data-testid":"sort",onChange:function(e){var t=e.target.value;u("default"===t?{}:{sortBy:t})},children:[Object(I.jsx)("option",{value:"default",children:"Any"}),Object(I.jsx)("option",{value:"price",children:"price"}),Object(I.jsx)("option",{value:"savings",children:"savings"}),Object(I.jsx)("option",{value:"dealRating",children:"deal rating"})]})]})]}),Object(I.jsx)("div",{className:"dashboard-container",children:Object(I.jsx)(L,{variables:Object(o.a)(Object(o.a)(Object(o.a)({},n),s),b)})})]})}n(89);function A(){var e=Object($.a)(v),t=e.data,n=e.error;if(e.loading)return Object(I.jsx)("div",{children:Object(I.jsx)("h4",{children:"Loading..."})});if(n)return Object(I.jsx)("div",{children:Object(I.jsx)("h4",{children:"Ops! An error occurred..."})});var c=t.onePerStore.filter((function(e){return null!==e}));return Object(I.jsxs)("div",{className:"anonymous-dashboard",children:[Object(I.jsx)(C,{dealsData:c}),Object(I.jsxs)("div",{className:"buttons-container",children:[Object(I.jsx)("button",{className:"link-button",children:Object(I.jsx)(O.b,{to:"/login",children:"Login"})}),Object(I.jsx)("button",{className:"link-button",children:Object(I.jsx)(O.b,{to:"/register",children:"Register"})})]})]})}n(90);var E=n(111);function R(e){var t=e.username,n=e.setUsername,c=Object(E.a)(y),a=Object(h.a)(c,2),r=a[0],s=a[1],i=s.error,l=s.data,o=Object(j.useState)(""),d=Object(h.a)(o,2),b=d[0],u=d[1],m=Object(j.useState)(""),f=Object(h.a)(m,2),g=f[0],v=f[1];if(Object(j.useEffect)((function(){(l||i)&&(l&&(localStorage.setItem("token",l.tokenAuth.token),n(l.tokenAuth.payload.username)),u(""),v(""))}),[l,i]),t)return Object(I.jsx)(x.a,{to:"/"});return Object(I.jsxs)("div",{className:"login-page",children:[Object(I.jsx)("h1",{children:"Login: "}),i?Object(I.jsx)("p",{style:{color:"red"},children:"Wrong Credentials!"}):null,Object(I.jsxs)("form",{onSubmit:function(e){e.preventDefault(),r({variables:{username:b,password:g}}).catch((function(e){return console.log(e)}))},className:"login-form",children:[Object(I.jsxs)("div",{children:[Object(I.jsx)("label",{children:"Username: "}),Object(I.jsx)("input",{type:"text",value:b,onChange:function(e){return u(e.target.value)}})]}),Object(I.jsxs)("div",{children:[Object(I.jsx)("label",{children:"Password: "}),Object(I.jsx)("input",{type:"password",value:g,onChange:function(e){return v(e.target.value)}})]}),Object(I.jsxs)("p",{children:["Don't have an account? Register ",Object(I.jsx)(O.b,{to:"/register",children:"here"})]}),Object(I.jsx)("button",{type:"submit",children:"continue"})]})]})}n(91);function B(e){var t=e.username,n=e.setUsername,c=Object(m.a)(),a=Object(E.a)(D),r=Object(h.a)(a,2),s=r[0],i=r[1],l=i.error,o=i.data,d=Object(j.useState)(!1),b=Object(h.a)(d,2),u=b[0],f=b[1],g=Object(j.useState)(!1),v=Object(h.a)(g,2),p=v[0],S=v[1],w=Object(j.useState)(""),k=Object(h.a)(w,2),$=k[0],N=k[1],P=Object(j.useState)(""),C=Object(h.a)(P,2),L=C[0],U=C[1],A=Object(j.useState)(""),R=Object(h.a)(A,2),B=R[0],T=R[1];if(Object(j.useEffect)((function(){(o||l)&&o&&setTimeout((function(){c.mutate({mutation:y,variables:{username:$,password:L}}).then((function(e){localStorage.setItem("token",e.data.tokenAuth.token),n(e.data.tokenAuth.payload.username)})).catch((function(e){console.log(e),S(!0)})),N(""),U(""),T("")}),1e3)}),[o,l]),t)return Object(I.jsx)(x.a,{to:"/"});return Object(I.jsxs)("div",{className:"registration-page",children:[Object(I.jsx)("h1",{children:"Register:"}),l?Object(I.jsx)("p",{style:{color:"red"},children:"Try something different!"}):null,o&&!p?Object(I.jsx)("p",{style:{color:"green"},children:"User Created! Logging In..."}):null,p?Object(I.jsx)("p",{style:{color:"red"},children:"Unable to login..."}):null,u?Object(I.jsx)("p",{style:{color:"red"},children:"Confirmation password doesn't match..."}):null,Object(I.jsxs)("form",{onSubmit:function(e){e.preventDefault(),L===B?(f(!1),s({variables:{username:$,password:L}}).catch((function(e){return console.log(e)}))):f(!0)},className:"registration-form",children:[Object(I.jsxs)("div",{children:[Object(I.jsx)("label",{children:"Username: "}),Object(I.jsx)("input",{disabled:!!o,type:"text",value:$,onChange:function(e){return N(e.target.value)}})]}),Object(I.jsxs)("div",{children:[Object(I.jsx)("label",{children:"Password: "}),Object(I.jsx)("input",{disabled:!!o,type:"password",value:L,onChange:function(e){return U(e.target.value)}})]}),Object(I.jsxs)("div",{children:[Object(I.jsx)("label",{children:"Password: "}),Object(I.jsx)("input",{className:B!==L?"red-input":"",disabled:!!o,type:"password",value:B,onChange:function(e){return T(e.target.value)}})]}),Object(I.jsxs)("p",{children:["Already have an account? Login ",Object(I.jsx)(O.b,{to:"/login",children:"here"})]}),Object(I.jsx)("button",{type:"submit",children:"Register"})]})]})}n(92);function T(e){var t=e.children;return Object(I.jsx)("div",{className:"navbar",children:t})}n(93);function q(e){var t=e.username,n=e.setUsername,c=Object(j.useState)(!1),a=Object(h.a)(c,2),r=a[0],s=a[1],i=function e(t){t.preventDefault(),document.removeEventListener("click",e),s(!1)};Object(j.useEffect)((function(){r&&document.addEventListener("click",i)}),[r]);var l=function(e){e.stopPropagation(),e.preventDefault(),r||s(!0)},o=function(e){e.preventDefault(),e.stopPropagation(),localStorage.removeItem("token"),i(e),n("")},d=function(){return Object(I.jsxs)("div",{className:"userinfo-menu",onClick:l,children:[Object(I.jsx)("p",{className:"userinfo-name",children:t||"guest"}),t?Object(I.jsx)("div",{className:"userinfo-logout-container",children:Object(I.jsx)("i",{className:"ri-logout-box-r-line userinfo-logout-btn",onClick:o})}):null]})};return Object(I.jsxs)("div",{children:[Object(I.jsx)("button",{className:"userinfo-btn",onClick:l,children:Object(I.jsx)("i",{className:"ri-account-circle-line"})}),r?Object(I.jsx)(d,{}):null]})}n(94),n(95);function G(){var e=Object(x.g)().id,t=Object($.a)(S,{variables:{id:e}}),n=(t.loading,t.data),c=t.error;if(c)return console.log(c),Object(I.jsx)("p",{children:"Oops! Something went wrong..."});if(n){var a=n.dealById,r=a.title,s=a.storeID,i=a.thumb,l=a.salePrice,o=a.normalPrice,j=a.steamRatingText,d=a.releaseDate,b=a.dealRating;return Object(I.jsxs)("div",{className:"detail-page-content",children:[Object(I.jsx)("img",{src:i,width:"200px"}),Object(I.jsx)("h1",{children:r}),Object(I.jsxs)("h3",{children:["on ",{1:"Steam",2:"Gog",3:"Humble Store"}[s]]}),Object(I.jsx)("div",{className:"info-block",children:Object(I.jsxs)("div",{className:"flex-wrapper",children:[Object(I.jsxs)("p",{children:["Price: ",l,"$ ",Object(I.jsxs)("span",{children:["Instead of ",o,"$"]})]}),Object(I.jsxs)("p",{children:["Deal rating: ",b]}),Object(I.jsxs)("p",{children:["Game rating: ",j]}),d>0?Object(I.jsxs)("p",{children:["Released:"," ",new Date(1e3*d).toLocaleDateString("en-US")]}):null]})}),Object(I.jsxs)("div",{children:[Object(I.jsx)("button",{children:Object(I.jsx)(O.b,{to:"/",children:"Back to list"})}),Object(I.jsx)("button",{children:Object(I.jsx)("a",{href:"".concat("https://www.cheapshark.com/redirect?dealID=").concat(e),children:"Go to store page"})})]})]})}return Object(I.jsx)("p",{children:"Loading... "})}var F=function(){var e=Object(j.useState)(null),t=Object(h.a)(e,2),n=t[0],c=t[1],a=Object(m.a)();return Object(j.useEffect)((function(){null===n&&a.query({query:w}).then((function(e){c(e.data.whoami)})).catch((function(e){console.log(e),localStorage.removeItem("token"),c("")}))}),[]),null===n?Object(I.jsx)("h1",{}):Object(I.jsx)(O.a,{children:Object(I.jsxs)("div",{className:"App",children:[Object(I.jsx)("nav",{children:Object(I.jsxs)(T,{children:[Object(I.jsx)(O.b,{to:"/",children:Object(I.jsx)("h1",{children:"Game Deals"})}),n?Object(I.jsx)(q,{username:n,setUsername:c}):null]})}),Object(I.jsxs)(x.d,{children:[Object(I.jsx)(x.b,{exact:!0,path:"/GameDealsDashboard-client",children:Object(I.jsx)(x.a,{to:"/"})}),Object(I.jsx)(x.b,{exact:!0,path:"/",children:n?Object(I.jsx)(U,{}):Object(I.jsx)(A,{})}),Object(I.jsx)(x.b,{exact:!0,path:"/login",children:Object(I.jsx)(R,{username:n,setUsername:c})}),Object(I.jsx)(x.b,{exact:!0,path:"/register",children:Object(I.jsx)(B,{username:n,setUsername:c})}),Object(I.jsx)(x.b,{path:"/detail/:id",children:Object(I.jsx)(G,{})})]})]})})},M=n(49),J=n(107),H=n(104),W=n(106),z=n(108),Q=n(105),V=new M.a((function(e,t){var n=localStorage.getItem("token");return console.log("auth link called!"),console.log(e),e.setContext((function(e){var t=e.headers;return{headers:Object(o.a)({authorization:n?"JWT ".concat(n):""},t)}})),t(e)})),K=new J.a({uri:"https://game-deals-dashboard.herokuapp.com/graphql/",credentials:"include"}),X=Object(H.a)([V,K]),Y=new W.a({link:X,cache:new z.a});u.a.render(Object(I.jsx)(d.a.StrictMode,{children:Object(I.jsx)(Q.a,{client:Y,children:Object(I.jsx)(F,{})})}),document.getElementById("root"))}},[[96,1,2]]]);
//# sourceMappingURL=main.2da634fa.chunk.js.map